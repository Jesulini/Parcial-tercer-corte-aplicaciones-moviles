<ion-header>
  <ion-toolbar color="dark">
    <ion-title>Mis Targets AR</ion-title>

    <ion-buttons slot="end">
      <ion-button (click)="logout()">
        <ion-icon name="log-out-outline"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content class="fire-background">

  <!-- Loader -->
  <div *ngIf="isLoading" class="loading-overlay">
    <ion-spinner name="crescent"></ion-spinner>
  </div>

  <!-- Subir archivos -->
  <div class="upload-container">
    <label class="upload-btn">
      <ion-icon name="cloud-upload-outline"></ion-icon>
      Subir Target
      <input
        type="file"
        multiple
        (change)="onFilesSelected($event)"
        hidden
      />
    </label>
  </div>

  <!-- Lista de targets -->
  <div class="cards-container">
    <div
      class="target-card fire-card"
      *ngFor="let t of targets"
      (click)="editTarget(t)"
    >
      <div class="card-header">
        <h2>{{ t.name }}</h2>
        <span class="type-tag">{{ t.type | uppercase }}</span>
      </div>

      <div class="card-preview">
        <!-- Imagen si existe -->
        <img
          *ngIf="t.contenturl"
          [src]="t.contenturl"
          alt="preview"
        />

        <!-- Para markers -->
        <p *ngIf="t.patternurl && !t.contenturl">Marker .patt</p>

        <!-- Para NFT sin imagen -->
        <p *ngIf="t.nfturlbase && !t.contenturl">NFT Target</p>
      </div>

      <div class="card-actions">
        <ion-button fill="outline" color="warning" (click)="editTarget(t); $event.stopPropagation()">
          Editar
        </ion-button>

        <ion-button fill="solid" color="danger" (click)="deleteTarget(t); $event.stopPropagation()">
          Eliminar
        </ion-button>
      </div>
    </div>
  </div>
</ion-content>
